<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1214px" preserveAspectRatio="none" style="width:779px;height:1214px;background:#FFFFFF;" version="1.1" viewBox="0 0 779 1214" width="779px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="327" x="219" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="317" x="224" y="22.9951">BonsaiDB :: Class Architecture Blueprint</text><rect fill="#F8F8FF" height="152.1953" id="_legend" rx="7.5" ry="7.5" style="stroke:#666666;stroke-width:1.0;" width="589" x="88" y="45.2969"/><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="94" y="65.3638"> </text><text fill="#222222" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225" x="98" y="65.3638">BonsaiDB Architecture Legend</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="323" y="65.3638"> </text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="327" y="65.3638"> </text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="98" y="80.4966">&lt;&lt;Component&gt;&gt;</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="331" y="80.4966">Class with main business logic.</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="98" y="95.6294">&lt;&lt;Utility&gt;&gt;</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="331" y="95.6294">Class that provides low-level services.</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="98" y="110.7622">&lt;&lt;Structure&gt;&gt;</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="331" y="110.7622">Structure defining the organization of data.</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="98" y="125.895">&lt;&lt;Data&gt;&gt;</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="331" y="125.895">Object representing user data.</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="94" y="141.0278">----</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="327" y="141.0278">----</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="98" y="156.1606">A *-- B</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="327" y="156.1606"> </text><text fill="#222222" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="331" y="156.1606">Composition</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="423" y="156.1606">: A owns B. B does not exist without A.</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="98" y="171.2935">A o-- B</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="327" y="171.2935"> </text><text fill="#222222" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="331" y="171.2935">Aggregation</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="423" y="171.2935">: A uses B. B can exist without A.</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="98" y="186.4263">A ..&gt; B</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="327" y="186.4263"> </text><text fill="#222222" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="92" x="331" y="186.4263">Dependency</text><text fill="#222222" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="423" y="186.4263">: A uses B (e.g., as a parameter).</text><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="53.2969" y2="53.2969"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="68.4297" y2="68.4297"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="83.5625" y2="83.5625"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="98.6953" y2="98.6953"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="113.8281" y2="113.8281"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="128.9609" y2="128.9609"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="144.0938" y2="144.0938"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="159.2266" y2="159.2266"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="174.3594" y2="174.3594"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="671" y1="189.4922" y2="189.4922"/><line style="stroke:#222222;stroke-width:1.0;" x1="94" x2="94" y1="53.2969" y2="189.4922"/><line style="stroke:#222222;stroke-width:1.0;" x1="327" x2="327" y1="53.2969" y2="189.4922"/><line style="stroke:#222222;stroke-width:1.0;" x1="671" x2="671" y1="53.2969" y2="189.4922"/><!--MD5=[25bd5e9105a7d8b9513a185a860b0295]
cluster Engine Core--><g id="cluster_Engine Core"><path d="M132.5,212.4922 L229.5,212.4922 A3.75,3.75 0 0 1 232,214.9922 L239,234.7891 L479.5,234.7891 A2.5,2.5 0 0 1 482,237.2891 L482,596.9922 A2.5,2.5 0 0 1 479.5,599.4922 L132.5,599.4922 A2.5,2.5 0 0 1 130,596.9922 L130,214.9922 A2.5,2.5 0 0 1 132.5,212.4922 " fill="#F7F7F7" style="stroke:#666666;stroke-width:1.5;"/><line style="stroke:#666666;stroke-width:1.5;" x1="130" x2="239" y1="234.7891" y2="234.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="96" x="134" y="227.4873">Engine Core</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="66" x="277" y="249.7842">«Engine»</text></g><!--MD5=[07cae965747ee1c7bffd7fd64e75133c]
cluster Storage Layer--><g id="cluster_Storage Layer"><rect fill="#F7F7F7" height="338" rx="35" ry="35" style="stroke:#666666;stroke-width:1.0;" width="428" x="255" y="648.4922"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="111" x="413.5" y="668.4873">Storage Layer</text></g><!--MD5=[b11171ad3bb551d33cdfdc5c1810e1ae]
cluster Data Structures--><g id="cluster_Data Structures"><path d="M8.5,1035.4922 L133.5,1035.4922 A3.75,3.75 0 0 1 136,1037.9922 L143,1057.7891 L612.5,1057.7891 A2.5,2.5 0 0 1 615,1060.2891 L615,1204.9922 A2.5,2.5 0 0 1 612.5,1207.4922 L8.5,1207.4922 A2.5,2.5 0 0 1 6,1204.9922 L6,1037.9922 A2.5,2.5 0 0 1 8.5,1035.4922 " fill="#F7F7F7" style="stroke:#666666;stroke-width:1.5;"/><line style="stroke:#666666;stroke-width:1.5;" x1="6" x2="143" y1="1057.7891" y2="1057.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="124" x="10" y="1050.4873">Data Structures</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="50" x="289.5" y="1072.7842">«Data»</text></g><!--MD5=[55c6f5a56b6751ce96fea1606eee0ec3]
class DatabaseEngine--><g id="elem_DatabaseEngine"><rect codeLine="43" fill="#FFFFFF" height="137.75" id="DatabaseEngine" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="273" x="192.5" y="263.4922"/><rect fill="#004080" height="40.2656" rx="2.5" ry="2.5" style="stroke:#004080;stroke-width:0.5;" width="273" x="192.5" y="263.4922"/><rect fill="#004080" height="2.5" style="stroke:#004080;stroke-width:0.5;" width="273" x="192.5" y="301.2578"/><rect codeLine="43" fill="none" height="137.75" id="DatabaseEngine" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="273" x="192.5" y="263.4922"/><ellipse cx="267.75" cy="283.625" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M270.7188,289.2656 Q270.1406,289.5625 269.5,289.7031 Q268.8594,289.8594 268.1563,289.8594 Q265.6563,289.8594 264.3281,288.2188 Q263.0156,286.5625 263.0156,283.4375 Q263.0156,280.3125 264.3281,278.6563 Q265.6563,277 268.1563,277 Q268.8594,277 269.5,277.1563 Q270.1563,277.3125 270.7188,277.6094 L270.7188,280.3281 Q270.0938,279.75 269.5,279.4844 Q268.9063,279.2031 268.2813,279.2031 Q266.9375,279.2031 266.25,280.2813 Q265.5625,281.3438 265.5625,283.4375 Q265.5625,285.5313 266.25,286.6094 Q266.9375,287.6719 268.2813,287.6719 Q268.9063,287.6719 269.5,287.4063 Q270.0938,287.125 270.7188,286.5469 L270.7188,289.2656 Z " fill="#000000"/><text fill="#0066CC" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="86" x="302.25" y="279.6309">«Component»</text><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="288.25" y="295.4561">DatabaseEngine</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="193.5" x2="464.5" y1="303.7578" y2="303.7578"/><ellipse cx="203.5" cy="317.4063" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247" x="212.5" y="320.7529">insert(record: const Record&amp;): bool</text><ellipse cx="203.5" cy="333.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="241" x="212.5" y="337.0498">find(id: int32_t): optional&lt;Record&gt;</text><ellipse cx="203.5" cy="350" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="212.5" y="353.3467">remove(id: int32_t): bool</text><line style="stroke:#0066CC;stroke-width:1.0;" x1="193.5" x2="464.5" y1="360.6484" y2="360.6484"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="371.2969"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="215" x="228.5" y="377.6436">index: unique_ptr&lt;BPlusTree&gt;</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="216.5" y="387.5938"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="228.5" y="393.9404">engine_mutex: shared_mutex</text></g><!--MD5=[8eac7a77b34bebb45bb5a932e15e2fa1]
class BPlusTree--><g id="elem_BPlusTree"><rect codeLine="52" fill="#FFFFFF" height="105.1563" id="BPlusTree" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="319" x="146.5" y="478.4922"/><rect fill="#004080" height="40.2656" rx="2.5" ry="2.5" style="stroke:#004080;stroke-width:0.5;" width="319" x="146.5" y="478.4922"/><rect fill="#004080" height="2.5" style="stroke:#004080;stroke-width:0.5;" width="319" x="146.5" y="516.2578"/><rect codeLine="52" fill="none" height="105.1563" id="BPlusTree" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="319" x="146.5" y="478.4922"/><ellipse cx="260.75" cy="498.625" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M263.7188,504.2656 Q263.1406,504.5625 262.5,504.7031 Q261.8594,504.8594 261.1563,504.8594 Q258.6563,504.8594 257.3281,503.2188 Q256.0156,501.5625 256.0156,498.4375 Q256.0156,495.3125 257.3281,493.6563 Q258.6563,492 261.1563,492 Q261.8594,492 262.5,492.1563 Q263.1563,492.3125 263.7188,492.6094 L263.7188,495.3281 Q263.0938,494.75 262.5,494.4844 Q261.9063,494.2031 261.2813,494.2031 Q259.9375,494.2031 259.25,495.2813 Q258.5625,496.3438 258.5625,498.4375 Q258.5625,500.5313 259.25,501.6094 Q259.9375,502.6719 261.2813,502.6719 Q261.9063,502.6719 262.5,502.4063 Q263.0938,502.125 263.7188,501.5469 L263.7188,504.2656 Z " fill="#000000"/><text fill="#0066CC" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="86" x="279.25" y="494.6309">«Component»</text><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="286.75" y="510.4561">BPlusTree</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="147.5" x2="464.5" y1="518.7578" y2="518.7578"/><line style="stroke:#0066CC;stroke-width:0.5;" x1="147.5" x2="464.5" y1="526.7578" y2="526.7578"/><ellipse cx="157.5" cy="540.4063" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="293" x="166.5" y="543.7529">insert(key: int32_t, page_id: uint32_t): void</text><ellipse cx="157.5" cy="556.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="281" x="166.5" y="560.0498">search(key: int32_t): optional&lt;uint32_t&gt;</text><ellipse cx="157.5" cy="573" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="181" x="166.5" y="576.3467">remove(key: int32_t): bool</text></g><!--MD5=[39c2281ae53c3ff3a0b7fb6db148b969]
class FileManager--><g id="elem_FileManager"><rect codeLine="60" fill="#FFFFFF" height="105.1563" id="FileManager" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="397" x="270.5" y="683.4922"/><rect fill="#004080" height="40.2656" rx="2.5" ry="2.5" style="stroke:#004080;stroke-width:0.5;" width="397" x="270.5" y="683.4922"/><rect fill="#004080" height="2.5" style="stroke:#004080;stroke-width:0.5;" width="397" x="270.5" y="721.2578"/><rect codeLine="60" fill="none" height="105.1563" id="FileManager" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="397" x="270.5" y="683.4922"/><ellipse cx="423.25" cy="703.625" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M426.2188,709.2656 Q425.6406,709.5625 425,709.7031 Q424.3594,709.8594 423.6563,709.8594 Q421.1563,709.8594 419.8281,708.2188 Q418.5156,706.5625 418.5156,703.4375 Q418.5156,700.3125 419.8281,698.6563 Q421.1563,697 423.6563,697 Q424.3594,697 425,697.1563 Q425.6563,697.3125 426.2188,697.6094 L426.2188,700.3281 Q425.5938,699.75 425,699.4844 Q424.4063,699.2031 423.7813,699.2031 Q422.4375,699.2031 421.75,700.2813 Q421.0625,701.3438 421.0625,703.4375 Q421.0625,705.5313 421.75,706.6094 Q422.4375,707.6719 423.7813,707.6719 Q424.4063,707.6719 425,707.4063 Q425.5938,707.125 426.2188,706.5469 L426.2188,709.2656 Z " fill="#000000"/><text fill="#0066CC" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="48" x="461.25" y="699.6309">«Utility»</text><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="443.75" y="715.4561">FileManager</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="271.5" x2="666.5" y1="723.7578" y2="723.7578"/><line style="stroke:#0066CC;stroke-width:0.5;" x1="271.5" x2="666.5" y1="731.7578" y2="731.7578"/><ellipse cx="281.5" cy="745.4063" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="371" x="290.5" y="748.7529">writePage(pageId: uint32_t, page: const Page&amp;): bool</text><ellipse cx="281.5" cy="761.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="326" x="290.5" y="765.0498">readPage(pageId: uint32_t, page: Page&amp;): bool</text><ellipse cx="281.5" cy="778" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="290.5" y="781.3467">allocatePage(): uint32_t</text></g><!--MD5=[6a494c20d032ff54e1efa92c1369bc7b]
class Page--><g id="elem_Page"><rect codeLine="66" fill="#FFFFFF" height="105.1563" id="Page" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="310" x="314" y="865.4922"/><rect fill="#004080" height="40.2656" rx="2.5" ry="2.5" style="stroke:#004080;stroke-width:0.5;" width="310" x="314" y="865.4922"/><rect fill="#004080" height="2.5" style="stroke:#004080;stroke-width:0.5;" width="310" x="314" y="903.2578"/><rect codeLine="66" fill="none" height="105.1563" id="Page" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="310" x="314" y="865.4922"/><ellipse cx="430.25" cy="885.625" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M433.2188,891.2656 Q432.6406,891.5625 432,891.7031 Q431.3594,891.8594 430.6563,891.8594 Q428.1563,891.8594 426.8281,890.2188 Q425.5156,888.5625 425.5156,885.4375 Q425.5156,882.3125 426.8281,880.6563 Q428.1563,879 430.6563,879 Q431.3594,879 432,879.1563 Q432.6563,879.3125 433.2188,879.6094 L433.2188,882.3281 Q432.5938,881.75 432,881.4844 Q431.4063,881.2031 430.7813,881.2031 Q429.4375,881.2031 428.75,882.2813 Q428.0625,883.3438 428.0625,885.4375 Q428.0625,887.5313 428.75,888.6094 Q429.4375,889.6719 430.7813,889.6719 Q431.4063,889.6719 432,889.4063 Q432.5938,889.125 433.2188,888.5469 L433.2188,891.2656 Z " fill="#000000"/><text fill="#0066CC" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="73" x="448.75" y="881.6309">«Structure»</text><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="467.75" y="897.4561">Page</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="315" x2="623" y1="905.7578" y2="905.7578"/><line style="stroke:#0066CC;stroke-width:0.5;" x1="315" x2="623" y1="913.7578" y2="913.7578"/><ellipse cx="325" cy="927.4063" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="284" x="334" y="930.7529">addRecord(record: const Record&amp;): bool</text><ellipse cx="325" cy="943.7031" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="334" y="947.0498">getRecords(): const vector&lt;Record&gt;</text><ellipse cx="325" cy="960" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="334" y="963.3467">removeRecord(id: int32_t): bool</text></g><!--MD5=[5c85d133e2c913f4b8608c8db253c015]
class Record--><g id="elem_Record"><rect codeLine="74" fill="#FFFFFF" height="105.1563" id="Record" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="260" x="339" y="1086.4922"/><rect fill="#004080" height="40.2656" rx="2.5" ry="2.5" style="stroke:#004080;stroke-width:0.5;" width="260" x="339" y="1086.4922"/><rect fill="#004080" height="2.5" style="stroke:#004080;stroke-width:0.5;" width="260" x="339" y="1124.2578"/><rect codeLine="74" fill="none" height="105.1563" id="Record" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="260" x="339" y="1086.4922"/><ellipse cx="439.75" cy="1106.625" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M442.7188,1112.2656 Q442.1406,1112.5625 441.5,1112.7031 Q440.8594,1112.8594 440.1563,1112.8594 Q437.6563,1112.8594 436.3281,1111.2188 Q435.0156,1109.5625 435.0156,1106.4375 Q435.0156,1103.3125 436.3281,1101.6563 Q437.6563,1100 440.1563,1100 Q440.8594,1100 441.5,1100.1563 Q442.1563,1100.3125 442.7188,1100.6094 L442.7188,1103.3281 Q442.0938,1102.75 441.5,1102.4844 Q440.9063,1102.2031 440.2813,1102.2031 Q438.9375,1102.2031 438.25,1103.2813 Q437.5625,1104.3438 437.5625,1106.4375 Q437.5625,1108.5313 438.25,1109.6094 Q438.9375,1110.6719 440.2813,1110.6719 Q440.9063,1110.6719 441.5,1110.4063 Q442.0938,1110.125 442.7188,1109.5469 L442.7188,1112.2656 Z " fill="#000000"/><text fill="#0066CC" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="44" x="463.25" y="1102.6309">«Data»</text><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="460.25" y="1118.4561">Record</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="340" x2="598" y1="1126.7578" y2="1126.7578"/><ellipse cx="350" cy="1140.4063" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="359" y="1143.7529">id: int32_t</text><ellipse cx="350" cy="1156.7031" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="359" y="1160.0498">name: char[50]</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="340" x2="598" y1="1167.3516" y2="1167.3516"/><ellipse cx="350" cy="1181" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="234" x="359" y="1184.3467">getRecordSize(): constexpr size_t</text></g><!--MD5=[dfe6ecaabf6168bd5852ee990a8d1994]
class BPlusNode--><g id="elem_BPlusNode"><rect codeLine="80" fill="#FFFFFF" height="105.1563" id="BPlusNode" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="282" x="22" y="1086.4922"/><rect fill="#004080" height="40.2656" rx="2.5" ry="2.5" style="stroke:#004080;stroke-width:0.5;" width="282" x="22" y="1086.4922"/><rect fill="#004080" height="2.5" style="stroke:#004080;stroke-width:0.5;" width="282" x="22" y="1124.2578"/><rect codeLine="80" fill="none" height="105.1563" id="BPlusNode" rx="2.5" ry="2.5" style="stroke:#0066CC;stroke-width:0.5;" width="282" x="22" y="1086.4922"/><ellipse cx="120.75" cy="1106.625" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M123.7188,1112.2656 Q123.1406,1112.5625 122.5,1112.7031 Q121.8594,1112.8594 121.1563,1112.8594 Q118.6563,1112.8594 117.3281,1111.2188 Q116.0156,1109.5625 116.0156,1106.4375 Q116.0156,1103.3125 117.3281,1101.6563 Q118.6563,1100 121.1563,1100 Q121.8594,1100 122.5,1100.1563 Q123.1563,1100.3125 123.7188,1100.6094 L123.7188,1103.3281 Q123.0938,1102.75 122.5,1102.4844 Q121.9063,1102.2031 121.2813,1102.2031 Q119.9375,1102.2031 119.25,1103.2813 Q118.5625,1104.3438 118.5625,1106.4375 Q118.5625,1108.5313 119.25,1109.6094 Q119.9375,1110.6719 121.2813,1110.6719 Q121.9063,1110.6719 122.5,1110.4063 Q123.0938,1110.125 123.7188,1109.5469 L123.7188,1112.2656 Z " fill="#000000"/><text fill="#0066CC" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="73" x="142.75" y="1102.6309">«Structure»</text><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="141.25" y="1118.4561">BPlusNode</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="23" x2="303" y1="1126.7578" y2="1126.7578"/><ellipse cx="33" cy="1140.4063" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="42" y="1143.7529">is_leaf: bool</text><ellipse cx="33" cy="1156.7031" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="42" y="1160.0498">keys: vector&lt;int32_t&gt;</text><ellipse cx="33" cy="1173" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#2A2A2A" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256" x="42" y="1176.3467">children_page_ids: vector&lt;uint32_t&gt;</text><line style="stroke:#0066CC;stroke-width:0.5;" x1="23" x2="303" y1="1183.6484" y2="1183.6484"/></g><!--MD5=[ab400d53d4d567d927e375e4ae8a43ac]
reverse link DatabaseEngine to BPlusTree--><g id="link_DatabaseEngine_BPlusTree"><path codeLine="87" d="M319.48,414.8622 C316.96,436.3422 314.32,458.9322 312.04,478.3622 " fill="none" id="DatabaseEngine-backto-BPlusTree" style="stroke:#333333;stroke-width:1.0;"/><polygon fill="#333333" points="321.02,401.6622,316.3485,407.1555,319.6225,413.5805,324.294,408.0872,321.02,401.6622" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="318" y="444.5591">Composition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="304.3141" y="467.3475">1</text></g><!--MD5=[5342ec37145861e36c68061bb80578f6]
link DatabaseEngine to Record--><g id="link_DatabaseEngine_Record"><path codeLine="88" d="M465.76,343.5122 C584.66,360.5722 738,406.5122 738,529.9922 C738,529.9922 738,529.9922 738,918.9922 C738,995.8822 671.08,1050.5522 604,1086.0422 " fill="none" id="DatabaseEngine-to-Record" style="stroke:#333333;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#333333" points="599.17,1088.5622,608.9991,1087.9389,603.6014,1086.2464,605.2939,1080.8487,599.17,1088.5622" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="739" y="740.5591">Uses</text></g><!--MD5=[530469d78040116e33ed03be4fd3f2fc]
link BPlusTree to BPlusNode--><g id="link_BPlusTree_BPlusNode"><path codeLine="89" d="M281.61,583.5322 C273.14,601.5322 263.61,621.8822 255,640.4922 C218.51,719.3822 193.88,733.8822 174,818.4922 C152.89,908.3622 154.57,1016.3222 158.33,1080.9222 " fill="none" id="BPlusTree-to-BPlusNode" style="stroke:#333333;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#333333" points="158.65,1086.2722,162.1022,1077.0482,158.3497,1081.2812,154.1167,1077.5287,158.65,1086.2722" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="175" y="831.5591">Operates on</text></g><!--MD5=[d82e125572e5f28d2be15a5abd9e82e0]
reverse link DatabaseEngine to FileManager--><g id="link_DatabaseEngine_FileManager"><path codeLine="91" d="M434.97,410.7922 C454.49,430.4922 472.13,453.3222 483,478.4922 C511.65,544.8122 498.43,629.9122 484.86,683.4622 " fill="none" id="DatabaseEngine-backto-FileManager" style="stroke:#333333;stroke-width:1.0;"/><polygon fill="#333333" points="425.57,401.6622,427.0884,408.7116,434.1796,410.0213,432.6612,402.9719,425.57,401.6622" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="501" y="535.5591">Composition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="478.4537" y="672.461">1</text></g><!--MD5=[1af4d71e002c8e9308dec33cc8221740]
reverse link BPlusTree to FileManager--><g id="link_BPlusTree_FileManager"><path codeLine="92" d="M355.81,594.0322 C378.77,622.6122 405.69,656.1522 427.52,683.3322 " fill="none" id="BPlusTree-backto-FileManager" style="stroke:#333333;stroke-width:1.0;"/><polygon fill="none" points="347.55,583.7422,348.192,590.9247,355.0688,593.0946,354.4269,585.9121,347.55,583.7422" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="383" y="628.5591">Aggregation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="413.4086" y="672.3135">1</text></g><!--MD5=[fb286dc4d84f06e793b8c13afce37d40]
link FileManager to Page--><g id="link_FileManager_Page"><path codeLine="93" d="M469,788.5722 C469,810.9822 469,837.3022 469,860.2522 " fill="none" id="FileManager-to-Page" style="stroke:#333333;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#333333" points="469,865.4022,473,856.4022,469,860.4022,465,856.4022,469,865.4022" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="470" y="831.5591">Manages</text></g><!--MD5=[2c91a79f49f083f3cee8bb2388ef4cfc]
link Page to Record--><g id="link_Page_Record"><path codeLine="95" d="M469,970.6122 C469,1003.7422 469,1046.7922 469,1080.9322 " fill="none" id="Page-to-Record" style="stroke:#333333;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#333333" points="469,1086.3322,473,1077.3322,469,1081.3322,465,1077.3322,469,1086.3322" style="stroke:#333333;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="470" y="1015.5591">Contains</text></g><!--MD5=[aed815908cd613b1739d6df3d9569aaf]
@startuml
title **BonsaiDB :: Class Architecture Blueprint**

skinparam backgroundColor #FFFFFF
skinparam shadowing false
skinparam ArrowColor #333333
skinparam BorderColor #444444
skinparam FontName "Segoe UI"
skinparam FontSize 12
skinparam DefaultTextAlignment center

skinparam package {
    BorderColor #666666
    BackgroundColor #F7F7F7
    BorderStyle solid
    FontColor #1A1A1A
}

skinparam class {
    BackgroundColor #FFFFFF
    BorderColor #0066CC
    BorderStyle solid
    HeaderBackgroundColor #004080
    FontColor #111111
    AttributeFontColor #2A2A2A
    StereotypeFontColor #0066CC
    HeaderFontColor #FFFFFF
}

skinparam note {
    BackgroundColor #FBFBFF
    BorderColor #0066CC
    FontColor #003366
}

skinparam legend {
    BackgroundColor #F8F8FF
    BorderColor #666666
    FontColor #222222
    FontSize 13
}

package "Engine Core" <<Engine>> {
    class DatabaseEngine <<Component>> {
        + insert(record: const Record&): bool
        + find(id: int32_t): optional<Record>
        + remove(id: int32_t): bool
        - -
        - index: unique_ptr<BPlusTree>
        - engine_mutex: shared_mutex
    }

    class BPlusTree <<Component>> {
        + insert(key: int32_t, page_id: uint32_t): void
        + search(key: int32_t): optional<uint32_t>
        + remove(key: int32_t): bool
    }
}

package "Storage Layer" <<Storage>> {
    class FileManager <<Utility>> {
        + writePage(pageId: uint32_t, page: const Page&): bool
        + readPage(pageId: uint32_t, page: Page&): bool
        + allocatePage(): uint32_t
    }

    class Page <<Structure>> {
        + addRecord(record: const Record&): bool
        + getRecords(): const vector<Record>
        + removeRecord(id: int32_t): bool
    }
}

package "Data Structures" <<Data>> {
    class Record <<Data>> {
        + id: int32_t
        + name: char[50]
        + {static} getRecordSize(): constexpr size_t
    }

    class BPlusNode <<Structure>> {
        + is_leaf: bool
        + keys: vector<int32_t>
        + children_page_ids: vector<uint32_t>
    }
}

DatabaseEngine *- - "1" BPlusTree : Composition
DatabaseEngine ..> Record : Uses
BPlusTree ..> BPlusNode : Operates on

DatabaseEngine *- - "1" FileManager : Composition
BPlusTree o- - "1" FileManager : Aggregation
FileManager ..> Page : Manages

Page ..> Record : Contains

legend top
| <b>BonsaiDB Architecture Legend</b> | |
| <<Component>> | Class with main business logic. |
| <<Utility>>   | Class that provides low-level services. |
| <<Structure>> | Structure defining the organization of data. |
| <<Data>>      | Object representing user data. |
|- - - -|- - - -|
| A *- - B | <b>Composition</b>: A owns B. B does not exist without A. |
| A o- - B | <b>Aggregation</b>: A uses B. B can exist without A. |
| A ..> B | <b>Dependency</b>: A uses B (e.g., as a parameter). |
end legend
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>