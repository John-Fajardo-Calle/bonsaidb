<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="827px" preserveAspectRatio="none" style="width:1037px;height:827px;background:#FFFFFF;" version="1.1" viewBox="0 0 1037 827" width="1037px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="377" x="331" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="367" x="336" y="27.9951">BonsaiDB :: Flujo de Datos - Operación SELECT</text><rect fill="#3C7DC4" height="572.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="284" y="149.7266"/><rect fill="#BA68C8" height="166.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="554" y="286.3906"/><rect fill="#FFECB3" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="775" y="315.5234"/><rect fill="#FFECB3" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="775" y="506.4531"/><rect fill="none" height="219.7344" style="stroke:#000000;stroke-width:1.5;" width="1020" x="10" y="468.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="66" x2="66" y1="118.5938" y2="747.0547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289" x2="289" y1="118.5938" y2="747.0547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="558.5" x2="558.5" y1="118.5938" y2="747.0547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="779.5" x2="779.5" y1="118.5938" y2="747.0547"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="979" x2="979" y1="118.5938" y2="747.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="20" y="115.292">Usuario (CLI)</text><ellipse cx="66" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66,58.7969 L66,85.7969 M53,66.7969 L79,66.7969 M66,85.7969 L53,100.7969 M66,85.7969 L79,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="20" y="759.0498">Usuario (CLI)</text><ellipse cx="66" cy="770.8516" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66,778.8516 L66,805.8516 M53,786.8516 L79,786.8516 M66,805.8516 L53,820.8516 M66,805.8516 L79,820.8516 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#D1E8FF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="225" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="232" y="107.292">DatabaseEngine</text><rect fill="#D1E8FF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="225" y="746.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="232" y="766.0498">DatabaseEngine</text><rect fill="#E1BEE7" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="516.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="523.5" y="107.292">BPlusTree</text><rect fill="#E1BEE7" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="516.5" y="746.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="523.5" y="766.0498">BPlusTree</text><rect fill="#FFF8E1" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="731.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="738.5" y="107.292">FileManager</text><rect fill="#FFF8E1" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="731.5" y="746.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="738.5" y="766.0498">FileManager</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="938" y="115.292">Archivo .db</text><path d="M961,66.2969 C961,56.2969 979,56.2969 979,56.2969 C979,56.2969 997,56.2969 997,66.2969 L997,92.2969 C997,102.2969 979,102.2969 979,102.2969 C979,102.2969 961,102.2969 961,92.2969 L961,66.2969 " fill="#E8F5E9" style="stroke:#181818;stroke-width:1.5;"/><path d="M961,66.2969 C961,76.2969 979,76.2969 979,76.2969 C979,76.2969 997,76.2969 997,66.2969 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="938" y="759.0498">Archivo .db</text><path d="M961,772.3516 C961,762.3516 979,762.3516 979,762.3516 C979,762.3516 997,762.3516 997,772.3516 L997,798.3516 C997,808.3516 979,808.3516 979,808.3516 C979,808.3516 961,808.3516 961,798.3516 L961,772.3516 " fill="#E8F5E9" style="stroke:#181818;stroke-width:1.5;"/><path d="M961,772.3516 C961,782.3516 979,782.3516 979,782.3516 C979,782.3516 997,782.3516 997,772.3516 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#3C7DC4" height="572.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="284" y="149.7266"/><rect fill="#BA68C8" height="166.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="554" y="286.3906"/><rect fill="#FFECB3" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="775" y="315.5234"/><rect fill="#FFECB3" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="775" y="506.4531"/><polygon fill="#181818" points="272,145.7266,282,149.7266,272,153.7266,276,149.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="66" x2="278" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="73" y="144.6606">[1]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="98" y="144.6606">find(id)</text><line style="stroke:#181818;stroke-width:1.0;" x1="294" x2="336" y1="193.9922" y2="193.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="336" y1="193.9922" y2="206.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="295" x2="336" y1="206.9922" y2="206.9922"/><polygon fill="#181818" points="305,202.9922,295,206.9922,305,210.9922,301,206.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="301" y="181.3599">[2]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="326" y="173.7935">lock.acquire()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="326" y="188.9263">(Bloqueo compartido)</text><path d="M299,219.9922 L299,259.9922 L573,259.9922 L573,229.9922 L563,219.9922 L299,219.9922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M563,219.9922 L563,229.9922 L573,229.9922 L563,219.9922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="305" y="237.0591">Permite múltiples lecturas simultáneas,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="305" y="252.1919">pero bloquea escrituras.</text><polygon fill="#181818" points="542,282.3906,552,286.3906,542,290.3906,546,286.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="294" x2="548" y1="286.3906" y2="286.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="301" y="281.3247">[3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="326" y="281.3247">search(id)</text><polygon fill="#181818" points="763,311.5234,773,315.5234,763,319.5234,767,315.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="564" x2="769" y1="315.5234" y2="315.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="571" y="310.4575">[4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="596" y="310.4575">read_node(node_page_id)</text><polygon fill="#181818" points="967,340.6563,977,344.6563,967,348.6563,971,344.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="785" x2="973" y1="344.6563" y2="344.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="792" y="339.5903">[5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="817" y="339.5903">Lee nodos del índice</text><line style="stroke:#181818;stroke-width:1.0;" x1="781" x2="791" y1="373.7891" y2="369.7891"/><line style="stroke:#181818;stroke-width:1.0;" x1="781" x2="791" y1="373.7891" y2="377.7891"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="780" x2="978" y1="373.7891" y2="373.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="797" y="368.7231">[6]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="822" y="368.7231">Nodo índice</text><path d="M339,386.7891 L339,426.7891 L549,426.7891 L549,396.7891 L539,386.7891 L339,386.7891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M539,386.7891 L539,396.7891 L549,396.7891 L539,386.7891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="345" y="403.856">Navega el árbol B+</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="345" y="418.9888">en disco para buscar la clave.</text><line style="stroke:#181818;stroke-width:1.0;" x1="295" x2="305" y1="453.1875" y2="449.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="295" x2="305" y1="453.1875" y2="457.1875"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="294" x2="558" y1="453.1875" y2="453.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="311" y="448.1216">[7]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="336" y="448.1216">page_id encontrado/nullopt</text><path d="M10,468.1875 L74,468.1875 L74,475.3203 L64,485.3203 L10,485.3203 L10,468.1875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="219.7344" style="stroke:#000000;stroke-width:1.5;" width="1020" x="10" y="468.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="481.2544">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137" x="89" y="480.3979">[page_id encontrado]</text><polygon fill="#181818" points="763,502.4531,773,506.4531,763,510.4531,767,506.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="294" x2="769" y1="506.4531" y2="506.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="301" y="501.3872">[8]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="326" y="501.3872">readPage(page_id)</text><polygon fill="#181818" points="967,531.5859,977,535.5859,967,539.5859,971,535.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="785" x2="973" y1="535.5859" y2="535.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="792" y="530.52">[9]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="817" y="530.52">Lee la página de datos</text><line style="stroke:#181818;stroke-width:1.0;" x1="781" x2="791" y1="564.7188" y2="560.7188"/><line style="stroke:#181818;stroke-width:1.0;" x1="781" x2="791" y1="564.7188" y2="568.7188"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="780" x2="978" y1="564.7188" y2="564.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="797" y="559.6528">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="831" y="559.6528">Página con registros</text><line style="stroke:#181818;stroke-width:1.0;" x1="294" x2="336" y1="593.8516" y2="593.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="336" y1="593.8516" y2="606.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="295" x2="336" y1="606.8516" y2="606.8516"/><polygon fill="#181818" points="305,602.8516,295,606.8516,305,610.8516,301,606.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="301" y="588.7856">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="335" y="588.7856">Deserializa registros de la página</text><line style="stroke:#181818;stroke-width:1.0;" x1="67" x2="77" y1="635.9844" y2="631.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="67" x2="77" y1="635.9844" y2="639.9844"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="66" x2="283" y1="635.9844" y2="635.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="83" y="630.9185">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="117" y="630.9185">return optional&lt;Record&gt;</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1030" y1="644.9844" y2="644.9844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157" x="15" y="655.1948">[page_id no encontrado]</text><line style="stroke:#181818;stroke-width:1.0;" x1="67" x2="77" y1="679.9219" y2="675.9219"/><line style="stroke:#181818;stroke-width:1.0;" x1="67" x2="77" y1="679.9219" y2="683.9219"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="66" x2="283" y1="679.9219" y2="679.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="83" y="674.856">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="117" y="674.856">return nullopt</text><line style="stroke:#181818;stroke-width:1.0;" x1="294" x2="336" y1="721.0547" y2="721.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="336" x2="336" y1="721.0547" y2="734.0547"/><line style="stroke:#181818;stroke-width:1.0;" x1="289" x2="336" y1="734.0547" y2="734.0547"/><polygon fill="#181818" points="299,730.0547,289,734.0547,299,738.0547,295,734.0547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="301" y="715.9888">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="335" y="715.9888">lock.release()</text><!--MD5=[340dc7e52654c5ce362bf205fc0b5239]
@startuml
title **BonsaiDB :: Flujo de Datos - Operación SELECT**
autonumber "<b>[0]</b>"

actor "Usuario (CLI)" as User
participant "DatabaseEngine" as Engine #D1E8FF
participant "BPlusTree" as BTree #E1BEE7
participant "FileManager" as FM #FFF8E1
database "Archivo .db" as DB #E8F5E9

User -> Engine: find(id)
activate Engine #3C7DC4

Engine -> Engine: lock.acquire()\n(Bloqueo compartido)
note right of Engine: Permite múltiples lecturas simultáneas,\npero bloquea escrituras.

Engine -> BTree: search(id)
activate BTree #BA68C8

BTree -> FM: read_node(node_page_id)
activate FM #FFECB3
FM -> DB: Lee nodos del índice
DB - ->> FM: Nodo índice
deactivate FM

note left of BTree: Navega el árbol B+\nen disco para buscar la clave.

BTree - ->> Engine: page_id encontrado/nullopt
deactivate BTree

alt page_id encontrado
    Engine -> FM: readPage(page_id)
    activate FM #FFECB3
    FM -> DB: Lee la página de datos
    DB - ->> FM: Página con registros
    deactivate FM

    Engine -> Engine: Deserializa registros de la página
    Engine - ->> User: return optional<Record>
else page_id no encontrado
    Engine - ->> User: return nullopt
end

Engine -> Engine: lock.release()
deactivate Engine
@enduml

PlantUML version 1.2022.7(Mon Aug 22 17:01:30 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>